# Гибрид нейронной сети и поиска по дереву (Neural Network + Tree Search)

### Коротко: что это и зачем нужно
Это комбинация «интуиции» (нейросеть) и «логики» (поиск по дереву). Такой подход позволяет ИИ не просто угадывать лучший ход, но и просчитывать его последствия на много шагов вперед.

### Суть идеи
Нейросеть выступает в роли фильтра. Вместо того чтобы просматривать миллиарды случайных вариантов, поиск по дереву (MCTS) фокусируется только на тех ветках, которые нейросеть пометила как перспективные. Это делает поиск невероятно эффективным.

### Алгоритм действий (MCTS)
1. **Selection (Выбор)**: Выбираем путь в дереве, используя формулу баланса между уверенностью и изучением нового.
2. **Expansion (Расширение)**: Добавляем новый узел в дерево.
3. **Evaluation (Оценка)**: Нейросеть оценивает позицию (Value) и предсказывает лучшие ходы (Policy).
4. **Backup (Обновление)**: Обновляем статистику всех узлов по пути вверх, учитывая новую оценку.

### Практический пример
Классический подход в **AlphaGo**. Нейросеть сужает поиск до нескольких «человеческих» ходов, а MCTS проверяет их глубину, находя скрытые ловушки или победные комбинации.

### Формула (UCB1 для выбора узла)
$$S_i = \bar{X}_i + C \sqrt{\frac{\ln N}{n_i}}$$
*Где $\bar{X}_i$ — средняя награда узла, $N$ — общее число посещений родителя, $n_i$ — число посещений узла $i$, $C$ — константа исследования.*

### Советы и ошибки
- **Ошибка**: Слишком глубокий поиск при слабой нейросети (трата времени на плохие варианты).
- **Совет**: Подбирайте баланс $C$. Слишком маленькое значение заставит ИИ быть «узколобым», слишком большое — «рассеянным».

![Визуализация](../03_MuZero_Pattern/visual.png)
